{"version":3,"file":"projects_demos_app_demo-modules_drag-to-create-events_module_ts-es2015.js","mappings":"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","sources":["./projects/demos/app/demo-modules/demo-utils/calendar-header.component.ts","./projects/demos/app/demo-modules/demo-utils/module.ts","./projects/demos/app/demo-modules/drag-to-create-events/component.ts","./projects/demos/app/demo-modules/drag-to-create-events/template.html","./projects/demos/app/demo-modules/drag-to-create-events/module.ts"],"sourcesContent":["import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { CalendarView } from 'angular-calendar';\n\n@Component({\n  selector: 'mwl-demo-utils-calendar-header',\n  template: `\n    <div class=\"row text-center\">\n      <div class=\"col-md-4\">\n        <div class=\"btn-group\">\n          <div\n            class=\"btn btn-primary\"\n            mwlCalendarPreviousView\n            [view]=\"view\"\n            [(viewDate)]=\"viewDate\"\n            (viewDateChange)=\"viewDateChange.next(viewDate)\"\n          >\n            Previous\n          </div>\n          <div\n            class=\"btn btn-outline-secondary\"\n            mwlCalendarToday\n            [(viewDate)]=\"viewDate\"\n            (viewDateChange)=\"viewDateChange.next(viewDate)\"\n          >\n            Today\n          </div>\n          <div\n            class=\"btn btn-primary\"\n            mwlCalendarNextView\n            [view]=\"view\"\n            [(viewDate)]=\"viewDate\"\n            (viewDateChange)=\"viewDateChange.next(viewDate)\"\n          >\n            Next\n          </div>\n        </div>\n      </div>\n      <div class=\"col-md-4\">\n        <h3>{{ viewDate | calendarDate: view + 'ViewTitle':locale }}</h3>\n      </div>\n      <div class=\"col-md-4\">\n        <div class=\"btn-group\">\n          <div\n            class=\"btn btn-primary\"\n            (click)=\"viewChange.emit(CalendarView.Month)\"\n            [class.active]=\"view === CalendarView.Month\"\n          >\n            Month\n          </div>\n          <div\n            class=\"btn btn-primary\"\n            (click)=\"viewChange.emit(CalendarView.Week)\"\n            [class.active]=\"view === CalendarView.Week\"\n          >\n            Week\n          </div>\n          <div\n            class=\"btn btn-primary\"\n            (click)=\"viewChange.emit(CalendarView.Day)\"\n            [class.active]=\"view === CalendarView.Day\"\n          >\n            Day\n          </div>\n        </div>\n      </div>\n    </div>\n    <br />\n  `,\n})\nexport class CalendarHeaderComponent {\n  @Input() view: CalendarView;\n\n  @Input() viewDate: Date;\n\n  @Input() locale: string = 'en';\n\n  @Output() viewChange = new EventEmitter<CalendarView>();\n\n  @Output() viewDateChange = new EventEmitter<Date>();\n\n  CalendarView = CalendarView;\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { CalendarModule } from 'angular-calendar';\nimport { CalendarHeaderComponent } from './calendar-header.component';\n\n@NgModule({\n  imports: [CommonModule, FormsModule, CalendarModule],\n  declarations: [CalendarHeaderComponent],\n  exports: [CalendarHeaderComponent],\n})\nexport class DemoUtilsModule {}\n","import {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Injectable,\n  ViewEncapsulation,\n} from '@angular/core';\nimport { CalendarEvent, CalendarEventTitleFormatter } from 'angular-calendar';\nimport { WeekViewHourSegment } from 'calendar-utils';\nimport { fromEvent } from 'rxjs';\nimport { finalize, takeUntil } from 'rxjs/operators';\nimport { addDays, addMinutes, endOfWeek } from 'date-fns';\n\nfunction floorToNearest(amount: number, precision: number) {\n  return Math.floor(amount / precision) * precision;\n}\n\nfunction ceilToNearest(amount: number, precision: number) {\n  return Math.ceil(amount / precision) * precision;\n}\n\n@Injectable()\nexport class CustomEventTitleFormatter extends CalendarEventTitleFormatter {\n  weekTooltip(event: CalendarEvent, title: string) {\n    if (!event.meta.tmpEvent) {\n      return super.weekTooltip(event, title);\n    }\n  }\n\n  dayTooltip(event: CalendarEvent, title: string) {\n    if (!event.meta.tmpEvent) {\n      return super.dayTooltip(event, title);\n    }\n  }\n}\n\n@Component({\n  selector: 'mwl-demo-component',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  templateUrl: 'template.html',\n  providers: [\n    {\n      provide: CalendarEventTitleFormatter,\n      useClass: CustomEventTitleFormatter,\n    },\n  ],\n  styles: [\n    `\n      .disable-hover {\n        pointer-events: none;\n      }\n    `,\n  ],\n  encapsulation: ViewEncapsulation.None,\n})\nexport class DemoComponent {\n  viewDate = new Date();\n\n  events: CalendarEvent[] = [];\n\n  dragToCreateActive = false;\n\n  weekStartsOn: 0 = 0;\n\n  constructor(private cdr: ChangeDetectorRef) {}\n\n  startDragToCreate(\n    segment: WeekViewHourSegment,\n    mouseDownEvent: MouseEvent,\n    segmentElement: HTMLElement\n  ) {\n    const dragToSelectEvent: CalendarEvent = {\n      id: this.events.length,\n      title: 'New event',\n      start: segment.date,\n      meta: {\n        tmpEvent: true,\n      },\n    };\n    this.events = [...this.events, dragToSelectEvent];\n    const segmentPosition = segmentElement.getBoundingClientRect();\n    this.dragToCreateActive = true;\n    const endOfView = endOfWeek(this.viewDate, {\n      weekStartsOn: this.weekStartsOn,\n    });\n\n    fromEvent(document, 'mousemove')\n      .pipe(\n        finalize(() => {\n          delete dragToSelectEvent.meta.tmpEvent;\n          this.dragToCreateActive = false;\n          this.refresh();\n        }),\n        takeUntil(fromEvent(document, 'mouseup'))\n      )\n      .subscribe((mouseMoveEvent: MouseEvent) => {\n        const minutesDiff = ceilToNearest(\n          mouseMoveEvent.clientY - segmentPosition.top,\n          30\n        );\n\n        const daysDiff =\n          floorToNearest(\n            mouseMoveEvent.clientX - segmentPosition.left,\n            segmentPosition.width\n          ) / segmentPosition.width;\n\n        const newEnd = addDays(addMinutes(segment.date, minutesDiff), daysDiff);\n        if (newEnd > segment.date && newEnd < endOfView) {\n          dragToSelectEvent.end = newEnd;\n        }\n        this.refresh();\n      });\n  }\n\n  private refresh() {\n    this.events = [...this.events];\n    this.cdr.detectChanges();\n  }\n}\n","<div class=\"row\">\n  <div class=\"col-md-6\">\n    <div class=\"btn-group\">\n      <div\n        class=\"btn btn-primary\"\n        mwlCalendarPreviousView\n        [view]=\"'week'\"\n        [(viewDate)]=\"viewDate\"\n      >\n        Previous\n      </div>\n      <div\n        class=\"btn btn-outline-secondary\"\n        mwlCalendarToday\n        [(viewDate)]=\"viewDate\"\n      >\n        Today\n      </div>\n      <div\n        class=\"btn btn-primary\"\n        mwlCalendarNextView\n        [view]=\"'week'\"\n        [(viewDate)]=\"viewDate\"\n      >\n        Next\n      </div>\n    </div>\n  </div>\n  <div class=\"col-md-6 text-right\">\n    <h3>{{ viewDate | calendarDate:('weekViewTitle') }}</h3>\n  </div>\n</div>\n<br />\n\n<ng-template\n  #weekViewHourSegmentTemplate\n  let-segment=\"segment\"\n  let-locale=\"locale\"\n  let-segmentHeight=\"segmentHeight\"\n  let-isTimeLabel=\"isTimeLabel\"\n>\n  <div\n    #segmentElement\n    class=\"cal-hour-segment\"\n    [style.height.px]=\"segmentHeight\"\n    [class.cal-hour-start]=\"segment.isStart\"\n    [class.cal-after-hour-start]=\"!segment.isStart\"\n    [ngClass]=\"segment.cssClass\"\n    (mousedown)=\"startDragToCreate(segment, $event, segmentElement)\"\n  >\n    <div class=\"cal-time\" *ngIf=\"isTimeLabel\">\n      {{ segment.date | calendarDate:'weekViewHour':locale }}\n    </div>\n  </div>\n</ng-template>\n\n<mwl-calendar-week-view\n  [viewDate]=\"viewDate\"\n  [events]=\"events\"\n  [hourSegmentTemplate]=\"weekViewHourSegmentTemplate\"\n  [weekStartsOn]=\"weekStartsOn\"\n>\n</mwl-calendar-week-view>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { CalendarModule, DateAdapter } from 'angular-calendar';\nimport { adapterFactory } from 'angular-calendar/date-adapters/date-fns';\nimport { DemoComponent } from './component';\nimport { DemoUtilsModule } from '../demo-utils/module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    CalendarModule.forRoot({\n      provide: DateAdapter,\n      useFactory: adapterFactory,\n    }),\n    DemoUtilsModule,\n    RouterModule.forChild([{ path: '', component: DemoComponent }]),\n  ],\n  declarations: [DemoComponent],\n  exports: [DemoComponent],\n})\nexport class DemoModule {}\n"],"names":[],"sourceRoot":"webpack:///"}